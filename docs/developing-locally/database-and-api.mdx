---
sidebar_position: 2
---

# Database & API

How to locally set up the database and the API for the app.

## Overview
As you can see in the source code of the d1loop app, d1loop has a very simple database and API connection. And although it's pretty simple, it's still a work in progress.

Because I don't want to share the code of them, I will explain how the database and API work to let other people who want to use the code of d1loop locally with their own database (which also require you to have because if not the app will not work properly).

## The API interface
This is a detailed list of the API interface. You can simply create an API with a database similar to that yourself, by using Node.js & Express, MongoDB, or any other database service you want to use.

:::caution

In future updates for **d1loop**, I'm planning on adding likes for posts, stats and more features, so the whole database and API is going to be _re-written_, so this is NOT the final API and database interface\structre.

:::

#### Token (account) creation
This is the interface that will be used to create a new account in the database. Every account is actually a special token which the server (the database) will use to authenticate the user.

- End point: `/generate-token`
- Method: `GET`
- Request body: Nothing
- Response: 
```json
{
    "token": "generated token will be here"
}
```
The app gets the token from that JSON response and saves it locally. This token is used to authenticate the user in creating posts just to make sure no one spam the post creating process through the API.

#### Posts fetching
This is the interface that will be used to fetch the posts from the database through the API. 

- End point: `/posts`
- Method: `GET`
- Request body: Nothing
- Response:
```json
{
  "systemMessage": "A post that always will be on the top.",
  "posts": [
    "post one",
    "post two"
  ]
}
```
The app gets from the JSON response a system message which is the post at the top that containing a verified post from the developer. 
This can not be changed and doesn't need to be. However, you can add by yourself this feature if you want.
After the system message, the app gets an array of posts that stored in the database and maps them through the app interface.

#### Creating posts
This is the interface that will be used to create a new post that will be added to the database through the API.

- End poing: `/create-post`
- Method: `POST`
- Request query: `?token="user token"&post="post content"`
- Response:
```
Post created successfully.
```
The app sends using the token of the user as an authentication method to create a new post in the database.
You can use some sort of censoring slurs like I did using the [NPM `bad-words` package](https://www.npmjs.com/package/bad-words) which is really simple and easy to use.

